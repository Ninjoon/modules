# VTK Module

Generate wrappers around many VTK filters by parsing the ParaView XML files describing the filters.

This module depends on VTK, it is therefore recommended to use vcpkg for managing and building VTK.
Use a CMake preset similar to this to enable this VTK module:

```json
    {
      "name": "vtk-msvc-vcpkg",
      "displayName": "VTK MSVC VCPKG",
      "inherits" : ["modules", "msvc-dev-vcpkg"],
      "cacheVariables": {
        "VCPKG_TARGET_TRIPLET" :   "x64-windows",
        "VCPKG_FEATURE_FLAGS":     "-compilertracking",
        "VCPKG_INSTALL_OPTIONS":   "--x-abi-tools-use-exact-versions",
        "VCPKG_OVERLAY_PORTS" :    "${sourceDir}/tools/vcpkg;${sourceParentDir}/modules/tools/vcpkg",
        "VCPKG_MANIFEST_FEATURES": "vtk",

        "IVW_MODULE_VTK" :         { "type": "BOOL", "value": "ON" }
      }
    }
```

You can add `dumpbin.exe` (MSVC build) to the path in the same preset to reduce the CMake warnings generated by VTK.
```json
	  "environment": {
        "Path" : "C:/Program Files/Microsoft Visual Studio/2022/Enterprise/VC/Tools/MSVC/14.31.31103/bin/Hostx64/x64;$penv{Path}"
      },
```

The inherited `msvc-dev-vcpkg` preset assumes that vcpkg is located next to the Inviwo repo.
Recommended folder structure:

```
└── SomeDir
    ├── builds      <-- build folder, might use subfolder for different builds
    ├── inviwo      <-- the inviwo repo
    ├── modules     <-- the modules repo
    └── vcpkg       <-- the vcpkg repo
```


## Updating VTK and TTK filter processors (Maintainer Only)

To generate the wrappers run the following Python script from within `modules/misc/vtk/`

```
python ./tools/parsefilter.py -o generated/ --quiet --mode vtk
```

Currently, the wrappers are based on a XML description of the VTK ParaView filters [filters/filters.xml](https://github.com/Kitware/ParaView/blob/v5.7.0/ParaViewCore/ServerManager/SMApplication/Resources/filters.xml).
Note that this list may be outdated. After ParaView version 5.7, the filters were split up into many more files, and even more filters became vtkPV filters which are defined for a derived ParaView subclass.


### Updating TTK specific filters

The same Python script can be used to generate processors for the TTK ParaView filters. This requires, however, a local TTK source repository since the ParaView XML files are not included in the vcpkg installation.

```
python ./tools/parsefilter.py --ttkrepo <ttk source folder> -o ../../topovis/ttk/generated/ --quiet --mode ttk
```

It is possible to use the TTK sources from the local vcpkg build tree. For example:
```
python ./tools/parsefilter.py --ttkrepo ../../../vcpkg/buildtrees/topology-tool-kit/src/deecb0fbde-06c39bfe06.clean/ -o ../../topovis/ttk/generated/ --quiet --mode ttk
```
